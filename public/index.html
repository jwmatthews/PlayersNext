<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.3/underscore-min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.10/backbone-min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
    <!-- TODO: print media type might be inappropriate, ref RWD -->

    <link rel="stylesheet" media="screen" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" media="screen" href="http:////cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.0/css/bootstrap-responsive.min.css">
    <link href="assets/css/index.css" media="screen, print" type="text/css" rel="stylesheet"/>

    <style>
        /* Customize the navbar links to be fill the entire space of the .navbar */
        .navbar .navbar-inner {
            padding: 0;
        }
        .navbar .nav {
            margin: 0;
            display: table;
            width: 100%;
        }
        .navbar .nav li {
            display: table-cell;
            width: 1%;
            float: none;
        }
        .navbar .nav li a {
            font-weight: bold;
            text-align: center;
            border-left: 1px solid rgba(255,255,255,.75);
            border-right: 1px solid rgba(0,0,0,.1);
        }
        .navbar .nav li:first-child a {
            border-left: 0;
            border-radius: 3px 0 0 3px;
        }
        .navbar .nav li:last-child a {
            border-right: 0;
            border-radius: 0 3px 3px 0;
        }
    </style>

  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <h3 class="muted">PlayersNext</h3>
          <div class="navbar">
              <div class="navbar-inner">
                  <div class="container">
                      <ul class="nav">
                          <li class="active"><a href="#">All</a></li>
                          <li><a href="#">Baseball</a></li>
                          <li><a href="#">Basketball</a></li>
                          <li><a href="#">Football</a></li>
                          <li><a href="#">Hockey</a></li>
                          <li><a href="#">Soccer</a></li>
                          <li><a href="#">Swimming</a></li>
                          <li><a href="#">Tennis</a></li>
                          <li><a href="#"></a></li>
                      </ul>
                  </div>
              </div>
          </div><!-- /.navbar -->
       </div><!-- /.masthead -->

    <div id='body_container' class="body_container">
      <div class="page"></div>
    </div>

    <!-- TEMPLATES -->
    <script type="text/template" id="link-list-template">
        <% _.each(links, function(link) { %>
            <div class="row-fluid">
                <div class="span12">
                    <h2><%= link.get('url') %></h2>
                    <p><%= link.get('description') %></p>
                    <p><a class="btn" href="<%= link.get('url') %>">View &raquo;</a></p>
                </div><!--/span-->
            </div><!-- /row-fluid -->
        <% }); %>
    </script>
    <!-- END TEMPLATES -->
    </div> <!-- / container -->

    <!-- MAIN BACKBONE JS -->
    <script>
      // *************************************************************
      // Helper Methods
      // *************************************************************

      $.ajaxPrefilter(function(options, originalOptions, jqXHR) {
        options.url = '/api' + options.url;
        options.crossDomain = 'true';
      });

      // *************************************************************
      // View / Controller 
      // *************************************************************
      var Link = Backbone.Model.extend({
        url: function() {
          return this.id ? '/link/' + this.id : '/link';
        }
      });
      var Links = Backbone.Collection.extend({
        model: Link,
        url: '/link'
      });

      var LinkList = Backbone.View.extend({
        el: '.page',
        render: function() {
          var links = new Links();
          var cxt = this;
          links.fetch({
            success: function(results) {
              if (results.length <= 0) { 
                cxt.$el.html('<h4>There doesn\'t seem to be anything here.</h4>');
              } else {
                // Populate list here
                var template = _.template($('#link-list-template').html(), {links: links.models});
                cxt.$el.html(template);
              }
            }, 
            error: function(results, jqXHR) {
              console.log(jqXHR.statusText);
            }
          });
        }
      });

      // *************************************************************
      // Router 
      // *************************************************************
      var Router = Backbone.Router.extend({
        routes: {
            '': 'home'
        }
      });

      var linkList = new LinkList();

      var router = new Router();
      router.on('route:home', function() {
        linkList.render();
      });

      Backbone.history.start();
    </script>
    <!-- END MAIN BACKBONE JS -->
  </body>
</html>